import{j as K,l as de}from"./index-ujc56wpP.js";/* empty css                   *//* empty css                 */import{_ as ce}from"./el-button-CJSPZsu0.js";/* empty css                     */import{V as Y,v as pe,r as _,x as me,S as fe,M as e,u as o,J as ge,K as n,k as ve,B as m,a2 as b,ae as _e,O as be,P as ye,ac as F,y as L}from"./vue-DzW8nZN5.js";import{A as T,_ as he,B as Pe,o as Ae,$ as H,r as Ve,W as Ce,C as ke,a0 as we,t as De,V as Te,a1 as Ee,a2 as Ne,a3 as Se,a4 as I,a5 as xe,a6 as ze,a7 as qe,a8 as Ue,a9 as je,aa as Be,E as M,ab as $e}from"./element-DoOLEteU.js";import"./vxe-Blb_dANO.js";function Re(y){return K({url:"tables",method:"put",data:y})}function Fe(y){return K({url:"tables",method:"get",params:y})}const Le={total:0,currentPage:1,pageSizes:[10,20,50],pageSize:10,layout:"total, sizes, prev, pager, next, jumper"};function He(y={}){const f=Y({...Le,...y});return{paginationData:f,handleCurrentChange:V=>{f.currentPage=V},handleSizeChange:V=>{f.pageSize=V}}}const Ie=y=>de.post("undefined/generateQuotation",y),Me=""+new URL("S10948-VFN5F3LF.pdf",import.meta.url).href,Ke={class:"app-container"},Ye={class:"flex justify-between"},Qe={class:"table-wrapper"},Oe={class:"pager-wrapper"},Ge={class:"my-3"},Je=pe({name:"ElementPlus",__name:"index",setup(y){const f=_(!1),{paginationData:c,handleCurrentChange:x,handleSizeChange:V}=He(),z={id:void 0,invoiceNo:"",invoiceDate:"",invoiceAddress:"",invoiceTel:"",invoiceAttn:""},P=_(!1),E=_(null),i=_(T(z)),Q={invoiceDate:[{required:!0,trigger:"blur",message:"Please select a date"}],invoiceAddress:[{required:!0,trigger:"blur",message:"Please select the address"}],invoiceTel:[{required:!0,trigger:"blur",message:"Please enter the Tel"}],invoiceAttn:[{required:!0,trigger:"blur",message:"Please enter the Attn"}],invoiceTo:[{required:!0,trigger:"blur",message:"Please enter the To Name"}],bankAccount:[{required:!0,trigger:"blur",message:"Please enter the bank account"}]};function O(){var l;(l=E.value)==null||l.validate(t=>{if(!t){M.error("表单校验不通过");return}let r={...i.value,projectList:p.value};r.totalCount=p.value.reduce((d,g)=>d+g.amount,0),(i.value.id===void 0?Ie:Re)(r).then(()=>{M.success("操作成功"),P.value=!1,j()}).finally(()=>{f.value=!1})})}function G(){var l;(l=E.value)==null||l.clearValidate(),i.value=T(z),p.value=[]}function J(l){$e.confirm(`Delete No：${l.invoiceNo}，confirm deletion?`,"Tips",{confirmButtonText:"confirm",cancelButtonText:"cancel",type:"warning"}).then(()=>{}).catch(()=>{})}const q=_([{id:1,invoiceNo:"RB-000001",invoiceDate:"2023-01-01",invoiceTo:"yuwei",invoiceAddress:"Hong Kong",bankAccount:"Dah Sing Bank 311-018-080-738",invoiceAttn:"done",invoiceTel:"13800000000",projectList:[{description:"Project 1",qty:1,unitPrice:100,amount:100},{description:"Project 2",qty:1,unitPrice:200,amount:200},{description:"Project 3",qty:2,unitPrice:300,amount:600}]},{id:2,invoiceNo:"RB-000002",invoiceDate:"2023-01-02",invoiceTo:"wei",invoiceAddress:"Shenzhen",bankAccount:"Dah Sing Bank 311-018-080-738",invoiceAttn:"end",invoiceTel:"13800000000",projectList:[{description:"Project 1",qty:1,unitPrice:100,amount:100},{description:"Project 2",qty:1,unitPrice:200,amount:200},{description:"Project 3",qty:2,unitPrice:300,amount:600}]},{id:3,invoiceNo:"RB-000003",invoiceDate:"2023-01-03",invoiceTo:"yu",invoiceAddress:"Guangzhou",bankAccount:"Dah Sing Bank 311-018-080-738",invoiceAttn:"ready",invoiceTel:"13800000000",projectList:[{description:"Project 1",qty:1,unitPrice:100,amount:100},{description:"Project 2",qty:1,unitPrice:200,amount:200},{description:"Project 3",qty:2,unitPrice:300,amount:600}]}]),p=_([]),N=_([]),W=_([]),U=_(null),C=Y({username:"",phone:""});function j(){f.value=!0,Fe({currentPage:c.currentPage,size:c.pageSize,username:C.username,phone:C.phone}).then(({data:l})=>{c.total=l.total}).catch(()=>{q.value=[]}).finally(()=>{f.value=!1})}function B(){c.currentPage===1?j():c.currentPage=1}function X(){var l;(l=U.value)==null||l.resetFields(),B()}const Z=()=>{p.value.push({index:p.value.length,description:"",qty:1,unitPrice:0,amount:""})},ee=l=>{N.value=l},te=l=>{W.value=l},ne=()=>{N.value.forEach(l=>{p.value=p.value.filter(t=>t.index!==l.index)})},$=l=>{l.amount=l.qty*l.unitPrice||0},oe=l=>{const{columns:t,data:r}=l,s=[];return t.forEach((d,g)=>{if(g===0){s[g]=F("div",{style:{textDecoration:"underline"}},["Total"]);return}if(g!==4)return"";const w=r.map(h=>Number(h[d.property]));if(w.every(h=>Number.isNaN(h)))s[g]="N/A";else{const h=`HK$ ${w.reduce((u,k)=>{const S=Number(k);return Number.isNaN(S)?u:u+k},0)}`;s[g]=F("div",{class:"text-yellow-500 font-bold"},[h])}}),s},ae=()=>{window.open(Me,"_blank")},le=l=>{i.value=T(l),p.value=T(l.projectList),p.value.forEach((t,r)=>t.index=r),P.value=!0};return(l,t)=>{const r=Ve,s=ke,d=Ce,g=_e("SvgIcon"),w=De,h=Te,u=Ee,k=xe,S=ze,ie=Ae,A=Ue,D=qe,re=je,R=Be,ue=Pe,se=he;return L(),me("div",Ke,[fe((L(),ge(ie,{shadow:"never"},{default:n(()=>[m("div",Ye,[m("div",null,[e(r,{type:"primary",icon:o(H),onClick:t[0]||(t[0]=a=>P.value=!0)},{default:n(()=>t[11]||(t[11]=[b(" New ")])),_:1},8,["icon"])]),t[12]||(t[12]=m("div",null,null,-1)),m("div",null,[e(h,{ref_key:"searchFormRef",ref:U,inline:!0,model:o(C)},{default:n(()=>[e(d,{prop:"username",label:"No"},{default:n(()=>[e(s,{modelValue:o(C).username,"onUpdate:modelValue":t[1]||(t[1]=a=>o(C).username=a),placeholder:"Please Enter Keyword"},{suffix:n(()=>[e(r,{link:"",icon:o(we),onClick:B},null,8,["icon"])]),_:1},8,["modelValue"])]),_:1}),e(d,null,{default:n(()=>[e(w,{content:"Refresh"},{default:n(()=>[e(g,{name:"refresh",class:"svg-icon text-lg cursor-pointer select-none",onClick:X})]),_:1})]),_:1})]),_:1},8,["model"])])]),m("div",Qe,[e(k,{data:o(q),onSelectionChange:te,stripe:"","header-cell-style":{background:"#f5f7fa"}},{default:n(()=>[e(u,{prop:"invoiceNo",label:"No",width:"150",align:"center"}),e(u,{prop:"invoiceDate",label:"Date",width:"180",align:"center"}),e(u,{prop:"invoiceTo",label:"To",width:"120",align:"center"}),e(u,{prop:"invoiceAddress",label:"Address",align:"center"}),e(u,{prop:"bankAccount",label:"BankAccount",align:"center"}),e(u,{prop:"invoiceAttn",label:"Attn",align:"center"}),e(u,{prop:"invoiceTel",label:"Tel",width:"150",align:"center"}),e(u,{fixed:"right",label:"Action",width:"220",align:"center"},{default:n(a=>[e(r,{link:"",plain:"",icon:o(Ne),type:"warning",onClick:v=>le(a.row)},{default:n(()=>t[13]||(t[13]=[b(" Edit ")])),_:2},1032,["icon","onClick"]),e(r,{link:"",plain:"",icon:o(Se),type:"primary",onClick:be(ae,["stop"])},{default:n(()=>t[14]||(t[14]=[b(" View ")])),_:1},8,["icon"]),e(r,{link:"",plain:"",icon:o(I),type:"danger",onClick:v=>J(a.row)},{default:n(()=>t[15]||(t[15]=[b(" Delete ")])),_:2},1032,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),m("div",Oe,[e(S,{background:"",layout:o(c).layout,"page-sizes":o(c).pageSizes,total:o(c).total,"page-size":o(c).pageSize,"current-page":o(c).currentPage,onSizeChange:o(V),onCurrentChange:o(x)},null,8,["layout","page-sizes","total","page-size","current-page","onSizeChange","onCurrentChange"])])]),_:1})),[[se,o(f)]]),e(ue,{modelValue:o(P),"onUpdate:modelValue":t[10]||(t[10]=a=>ve(P)?P.value=a:null),title:o(i).id===void 0?"New":"Edit",width:"60%",onClosed:G},{footer:n(()=>[e(r,{onClick:t[9]||(t[9]=a=>P.value=!1)},{default:n(()=>t[19]||(t[19]=[b(" Cancel ")])),_:1}),e(r,{type:"primary",loading:o(f),onClick:O},{default:n(()=>t[20]||(t[20]=[b(" Submit ")])),_:1},8,["loading"])]),default:n(()=>[t[21]||(t[21]=m("span",{class:"font-bold text-xl"},"Quote information",-1)),e(h,{ref_key:"formRef",ref:E,model:o(i),rules:Q,"label-position":"top"},{default:n(()=>[e(D,{gutter:20},{default:n(()=>[e(A,{span:12},{default:n(()=>[e(d,{prop:"invoiceNo",label:"invoice No"},{default:n(()=>[e(s,{disabled:"",modelValue:o(i).invoiceNo,"onUpdate:modelValue":t[2]||(t[2]=a=>o(i).invoiceNo=a),placeholder:"Automatic production of the system",size:"large"},null,8,["modelValue"])]),_:1})]),_:1}),e(A,{span:12},{default:n(()=>[e(d,{prop:"invoiceTo",label:"invoice To"},{default:n(()=>[e(s,{placeholder:"Please Enter",modelValue:o(i).invoiceTo,"onUpdate:modelValue":t[3]||(t[3]=a=>o(i).invoiceTo=a),size:"large"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(D,{gutter:20},{default:n(()=>[e(A,{span:12},{default:n(()=>[e(d,{prop:"invoiceDate",label:"Invoice Date"},{default:n(()=>[e(re,{modelValue:o(i).invoiceDate,"onUpdate:modelValue":t[4]||(t[4]=a=>o(i).invoiceDate=a),type:"date",format:"YYYY/MM/DD",placeholder:"Pick a day","value-format":"YYYY-MM-DD",class:"w-full",size:"large"},null,8,["modelValue"])]),_:1})]),_:1}),e(A,{span:12},{default:n(()=>[e(d,{prop:"invoiceTel",label:"Tel"},{default:n(()=>[e(s,{modelValue:o(i).invoiceTel,"onUpdate:modelValue":t[5]||(t[5]=a=>o(i).invoiceTel=a),placeholder:"Please Enter",size:"large"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(D,{gutter:20},{default:n(()=>[e(A,{span:12},{default:n(()=>[e(d,{prop:"invoiceAddress",label:"Address"},{default:n(()=>[e(s,{modelValue:o(i).invoiceAddress,"onUpdate:modelValue":t[6]||(t[6]=a=>o(i).invoiceAddress=a),placeholder:"Please Enter",size:"large"},null,8,["modelValue"])]),_:1})]),_:1}),e(A,{span:12},{default:n(()=>[e(d,{prop:"bankAccount",label:"Bank Account"},{default:n(()=>[e(s,{modelValue:o(i).bankAccount,"onUpdate:modelValue":t[7]||(t[7]=a=>o(i).bankAccount=a),placeholder:"Please Enter",size:"large"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(D,{gutter:20},{default:n(()=>[e(A,{span:24},{default:n(()=>[e(d,{prop:"invoiceAttn",label:"Attn"},{default:n(()=>[e(s,{modelValue:o(i).invoiceAttn,"onUpdate:modelValue":t[8]||(t[8]=a=>o(i).invoiceAttn=a),type:"textarea",placeholder:"Please Enter",size:"large"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),t[22]||(t[22]=m("span",{class:"font-bold text-xl"},"Quote content",-1)),m("div",Ge,[e(r,{type:"primary",icon:o(H),onClick:Z},{default:n(()=>t[16]||(t[16]=[b(" New ")])),_:1},8,["icon"]),e(r,{type:"danger",onClick:ne,icon:o(I),disabled:o(N).length===0},{default:n(()=>t[17]||(t[17]=[b(" Delete ")])),_:1},8,["icon","disabled"])]),e(k,{"empty-text":"No Data","summary-method":oe,"show-summary":"","sum-text":"Total",onSelectionChange:ee,data:o(p),"highlight-current-row":"","header-cell-style":{background:"#f5f7fa"}},{default:n(()=>[e(u,{type:"selection",width:"80",align:"center"}),e(u,{prop:"description",label:"Description",align:"center"},{default:n(a=>[e(s,{modelValue:a.row.description,"onUpdate:modelValue":v=>a.row.description=v,type:"textarea",rows:1,placeholder:"Please Enter",size:"large"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{prop:"qty",label:"Qty",width:"180",align:"center"},{default:n(a=>[e(R,{"controls-position":"right",onChange:v=>$(a.row),modelValue:a.row.qty,"onUpdate:modelValue":v=>a.row.qty=v,min:1},null,8,["onChange","modelValue","onUpdate:modelValue"])]),_:1}),e(u,{prop:"unitPrice",label:"Unit Price(HK$)",width:"180",align:"center"},{default:n(a=>[e(R,{"controls-position":"right",modelValue:a.row.unitPrice,"onUpdate:modelValue":v=>a.row.unitPrice=v,min:0,onChange:v=>$(a.row)},{prefix:n(()=>t[18]||(t[18]=[m("span",null,"HK$",-1)])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(u,{prop:"amount",label:"Amount (HK$)",width:"150",align:"center"},{default:n(({row:a})=>[b(" HK$ "+ye(a.amount||0),1)]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue","title"])])}}}),lt=ce(Je,[["__scopeId","data-v-f92520e5"]]);export{lt as default};
